language: node_js
node_js:
- '5.12'
cache:
  directories:
  - node_modules
env:
  global:
  - secure: JZ+C8JAjS0c+goAtRbYpmrbZSIyMlIGFY/DsAy6Xz8sGwnpIvTrcCqu1+BQuuxDKAclNRsyoEnNERT2P0Gk6UifgJpyRusudxY8nDVNchL5KfGWaTzg/ofzNJqhExZ2o1zRwVVuVqexm57AWlgbtMLwJZxIByGMhdy6vEDKtBTg0ynPMK6DB45LaHMwf5BUN2dJX8EiTDJqEOS/QzjqxXsEpEGY5+4qrFeLIMbuFBL1SmIOnWEYh2Wpakv2ValpjxWDvo4fhuHzgJL31OzHo6im+vzakjK5pvjGqoFqVdfStZOSFrtn93gPMMDfrxnQRY6fo+Rd8js8UI3cI70LQnTSS/0YYMmM5oDtQtQ5VO2lgEth+++qN4HJ5Tgiidro/x00XY3mTXBeQbLgSo7il8LPq65TKPj1yH+oxvep01kUci7ZVrFobNLygL6WSCDy99JJnbqpDTb6lxHRFEsbQi6QFNCl8XdeVzNRmCO/4hF48m8bp2yutD/QV3vhC1ni4FAOZR1PUULmOtCRHIZwOnB2AnaZ2LsJ2N6hiFWvYImHKwHci8GAKAb4uEd6rpoGO0yStF0s4t36gR625cSivNxSbGr9r3FLNkeMm28dPxAUHa3MBIwDE7Z6cy6WX5YwTYT6qJhOsW9OLa8VgrQnvZgTyXFIPdLETqFdlf/UQY9o=
  - secure: jh3xzBVedX35gqjqs34vfGZH+/1mGNST9sluS0q2KXVOxSITX8rDQ10xcKgMc2oVwqg+XvYz0mLgeOcpAZlu6/awN+AHtJ0V6T70CYoeMKcU9s0p/ez5ACmWIFIbwwwCis1A9TTaB76LYemITSYmDgiBFDSJ8ZddS/Lcjo+8qJ7Tf89MV3Lta3OR+AouTmnr3bvB7CLNrQ7Rg/umEGkvaaB1Cl13Hds2VgnLgN6fs+UEgNi06tym9bopTPmrbZm3LEFFZ6pLwnNOrIq6ITsIL90Bbi1a5XAYHc+FyhY8JbuxbFv9X7OdqdJW395xM4+5iMb3fUErjxTNhuKBIhbTdW0MxrOlNMqTlkOf+EecltC2vKDtHJOybWtwnNdc2wkX618HoYabuqCuvEHC2DWFCuTEqURhE4ppNn6SMCRKxSrKKDoKrH505y8DMcjMXrqROheFiVItlSVAaEsa1+pPX7sa8DzTnV5+NkOOsCiNYoLw5E+0McXC4wALw3wRtEjwfpWk4kvSPXltoSDvwnUS5QqZi8FlbxLgSxXoLvmW5rkXGziH5wj2rO8IRD/9u/MZ4rc2faLSdB7ikV/mwsbO67bic/DuiHPtcLvVLN2xkz0akhtpVcvpB/2xpm+mTRSh2fXbbp8UBybfx/OC98NVJqGfDw4APRyXZ269daHXvYc=
  - secure: c+GpcRQEDjJ0TIKIqXqhJYfl9wHgpT+u4yYIOwnyE3oH4d6sbHAVf6xQHZP7vniO7j8t497EYOyz1RhvIX6dMAC0Am3hvHiCf3ByUY61manu1u1cW5ZOw6LDe+1pOXSfLcltDm5HBTNAsWjiDmIs5f/j7u4o89ze3Fwy9GsgGhi76yckQ2PNWpplTNC9CV08nan9LKRp1fuv4XIzl9jjNJtnv4yFOS+bvhvgdzBnLaeb6A43laoutvIMnPzfBwqXtRnL0Pktlhk0Rf6UOxv8fTriNW7d0+qXM3vjrVYuuDPuRMqoSkID81LfVBzbO1Ubh2BXyFZxY2LM+nEn0/FLF2Dz1nV/AlB0KcFvHoX8nr+q2jyALLxy/yPi9y6ZkaUxjo59xw1levlRI0LaSvNJfsSaU5iv0j6lgqSd2Xz/xX59mAw3Cy3qrvqD+gjPvEM1akF8xF6ODWvM9TegploCrOWm4FvkQ58c/EhtsOQHajjaThdIz+mgeLfQAkgU3wP8aIm7lV8mpOE8a3dPq03Kwebz8OXN82jwQteCGIdWzGOKHXhtrHEKmxtCf7ArFS8sPmf3uDynrbO/ihXNldDE6DO0SzCHdhcDIDaBVPMJHnjtkKipyii67MwaHASlzAfj7ofvRMNigscF0UFYGUBhRPsVQckyPg6eKLU7mdhQGds=
  - secure: l5saenP0W1Oyrs+HxOSyGkG9dYFU1cSGLqtGhV1QrpjhquXIPzzjk4twtTtoXya5rFXzv7wJ9XEFwwweaR/6r+ww2kto5ZUXGZqWy7IMk2bkVw9RWo84C3JMJdrq3qCYq4H9WXrNWN76etBkqk74NcZ2wqb+tn1cgkRJLnZhCJQHQqF3TK5wq5bM3L5hJk9jeR4RJmXGztf0wdt0UmHmwrOYZthgL/PNgPEsqbZQe2sajld5QqbvG9TAdduuJP4ahRNGBfdXVgmxoPyaX+7sp647r76xGqggXY2BXw+MnI1p3acw1mNaw1gVLfU2BF61klJAty2UmP1kzXTnMkqcbNdVUqDlb88HccNP+saGYjLC0as7qUGKGxFtwc+EjkjKEh2gMe1wtrrMIKsVwyNU9C18GqD98fmnZ2d3eraYYSwS6IOnnZd+T6X8bKTlZnjcetmTBdGP34ozoUbh/bSddd4hihpiD1AFXSK7jOS3an1Ls9H96DCO71fNV0Pxs+79l69rZ46+suIKZM3jXhFzWxzPv95chJpT7vcfu4rGFlCtf/M3PzQYtO6HFOd+qCf89+I7FEp9amWtWTTVuffdS0R49Jlxah7kFNcevMh2L5kMWdnY2ecN0prhbj7Pwluf1xi2zyc0nhSq3WEy2IMrLNF3pxTMDroveq6ExHSadn4=
  - secure: p8Jgo5Zco1UVUaMEw1omYmAVcOwKKoI3HjlfyHH8fnNoFcuZQIIPc8i6HOWR7SdntwzDPnTlHgUjGXBe9/qZsqBGpPdnMzmO5fYV+vI8TbgKzHRV9ztyzzp5CxNU9XUSJfeCer1O1zGd0tZZO0foD93FCYdzhiwro3o/kuR1navIXCCBL4YT1Yqg3faoVGjftY1yizo1Cy7dh/giB6Mz1AX5QYuGrV+UVepgMVGvZbl8bmLGUk79uaO3X0wWHvd+6CFkXzX3bKf6/qRkWIZV/B2Svdj6moedM0fEe2miUMbG8beCuMRJ3Vaz2aUXXU+P2Vy00jtX7A8uwj5nGf5XRM+XZDsYsCFez2vI2jCylN60s6HfibjegX7d5uUqeh5CfDinPK6fgjynosdkDG/CnyuLhsKZ5FNFKO/adMi/UQaH77gxtUVIOpHzF0tql8J4KHwIBzOdgD9G0B+gWMLPZV1lR+r51d5vbfo0bcrJlMhKxPVPzUoT2AwzCkLM8DlR4HKcxtHlTJXl9QPG3yM6/mgOu4pd/8Fi+SXg4xMJ8i7irZv9JCJHdgLaGkXv4omgoQgtP3BjZUqB3Stptimy5ifuLvOqDMUA9eVF47qNbpx1AISS6PyCAjhe+9YdGLE4vhwR2s+9vn1UchEe4fDimXcU3GXsO18Fplfulss44pk=
  - secure: Zm3+w0VQRPg/MYL5driKpXz8w41q8bugXO1sVxq2l5ct0cbRW219Gbn1PVCe/R+RQK9imj0MO3Bnp2aNgwEjx6N/sHWUk8Q+CZDc8fJR3LMA+/cfw33QpoJuepxeWcSvpPoQFKII1k241XKCtKPcH3oFDz4ty3V3dXlTRSp6yO3dhHbEoQXPIBvjtYFkbl8LszuBOkoEhd1BlWwSBvlS4EX7kZIRToepplzNVgybqMVv1DaUV1Dimx+nzORqGq40+rFFf9GEbUqHuN3aDnvb83WQzQiyw2/i1bKG9vOcM6niyP2Vg4ypX3jDLLPdKwTHvaJusUX9HaUVjPPsRgdb9E2eec7UaJ76N0zdcvKSuLe78tmn+u1XlFoeAGET5BfyjcetmednQYbSE85Y+Ft0CkpYAw9L0KjgFJlrN9aTJ8Kl689xCYk+GSNfHVG7J3du47MZQAQZ06rjoOLihrO130d3A59gFsXY5L/wWRrhTDl2pqkKGfJxQSNaoLeO1Rmcz19V+IEvoxoxEaIPhF5tMKFyR9db4o+qR1znrb8jT+2Mn/x47rOtw7ZBYdaPmXC1Z11IyO2RRZAXPwVh2LLRp9WAMkhkqL/PNF/Juu5rptz0LBTAH3o1wTlfP3uNfigtOgxAQlfArVL6wI+YrvFcXUBUnq5XOzBbiTLI9LDZplk=
sudo: required
services:
- docker
after_success:
- echo $DOCKER_USERNAME
- image=liping511/mtaas:$(date +"%Y%m%d%H%M%S")
- docker build -t $image --build-arg MYSQL_DB_HOST=$MYSQL_DB_HOST --build-arg MYSQL_DB_PORT=$MYSQL_DB_PORT
  --build-arg MYSQL_DB_USERNAME=$MYSQL_DB_USERNAME --build-arg MYSQL_DB_PASSWORD=$MYSQL_DB_PASSWORD
  --build-arg MYSQL_DB_DATABASE=$MYSQL_DB_DATABASE .
- docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
- docker push $image
